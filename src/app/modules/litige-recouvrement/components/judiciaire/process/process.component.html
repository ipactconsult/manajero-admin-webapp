<div class="row mt-3">
    <h3>

        Legal Recovery Process

    </h3>
</div>
<br>
<nb-card class="col-md-12 col-lg-12 col-xxxl-12">
    <nb-card-body>
        <nb-stepper orientation="horizontal" [disableStepNavigation]="disabled">

            <nb-step [label]="labelOne">
                <div class="row">

                    <ng-template #labelOne>The Parts</ng-template>
                    <div class="col-md-6">
                        <h5>
                            <nb-icon icon="people-outline"></nb-icon> &nbsp;Identity of the customer
                        </h5><br>
                        <div class="form-group">

                            <label>Customer Name:</label>
                            &nbsp;
                            <nb-tag status="info" appearance="filled" text=" {{dossier?.relance?.invoice?.clientName}} ">
                            </nb-tag>



                            <br>
                            <br>
                            <label>Customer Mail:</label>
                            &nbsp;
                            <nb-tag status="success" appearance="filled" text=" {{dossier?.relance?.invoice?.clientEmail}} ">
                            </nb-tag>


                            <br>
                            <br>
                            <label>Customer Phone:</label>
                            &nbsp;
                            <nb-tag status="danger" appearance="filled" text=" {{dossier?.relance?.invoice?.clientPhone}} ">
                            </nb-tag>




                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>
                            <nb-icon icon="file-text-outline"></nb-icon> &nbsp;The bill
                        </h6>
                        <br>
                        <div class="form-group">
                            <label>Reference invoice :</label>
                            &nbsp;

                            <nb-tag status="warning" appearance="filled" text=" {{dossier?.relance?.invoice?.code}} "></nb-tag>

                            <br>
                            <br>

                            <label>Title:</label>
                            &nbsp;
                            <nb-tag status="danger" appearance="filled" text=" {{dossier?.relance?.invoice?.title}} "></nb-tag>

                            <br>
                            <br>
                            <label>Total:</label>
                            &nbsp;
                            <nb-tag status="success" appearance="filled" text=" {{dossier?.relance?.invoice?.total}} "></nb-tag>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">

                    </div>
                    <div class="col-md-6">

                        <button nbButton status="basic" nbButton nbStepperNext>next</button>
                    </div>
                </div>
            </nb-step>




            <nb-step [label]="labelTwo">
                <div class="col-md-12">
                    <ng-template #labelTwo>Penalties relating to invoices</ng-template>
                    <div class="col-md-12" align="right">
                        <a status="warning" nbButton class="mx-1" nbTooltip="click here to know how calculate penalites"
                            nbTooltipStatus="primary">
                            <nb-icon icon="question-mark-circle-outline"></nb-icon>

                        </a>
                        <ng-template #contentTemplate let-data>
                            <ngx-img></ngx-img>
                        </ng-template>

                    </div>
                    <br>

                    <div class="form-group ">

                        
                            <label> Total amount :</label>

                            &nbsp;

                        
                            <nb-tag status="success" appearance="filled" text=" {{dossier?.relance?.invoice?.total}} Dinars "></nb-tag>

                        
                    </div>
                    <div class="form-group ">

                            <label>Number of days late : </label>
                            &nbsp;

                            <nb-tag status="success" appearance="filled" text=" {{days}} Days "></nb-tag>

                        

                    </div>
                    <div class="form-group ">
                            <label>Applicable Rate </label>


                        &nbsp;
                        <input class="col-md-3" nbInput [(ngModel)]="taux" type="number" placeholder="Rate with %"  />
                        <div *ngIf="categoriename?.invalid && (categoriename?.dirty || categoriename?.touched)">
                            <p class="text-danger" *ngIf="title?.errors?.required">*Required</p>
                        </div>


                    </div>
                    <div class="form-group" align="right" >
                        <button nbButton status="info" (click)="calculatePenalty()">Calculate</button>
                </div>
                    <div *ngIf="showPenalty" class="form-group ">
                        <label>Total Penalty </label>


                    &nbsp;
                    <nb-tag status="danger" appearance="filled" text="  {{penalty}} Dinars "></nb-tag>



                </div>
                <div class="form-group " *ngIf="showPenalty">
                    <label>Total to pay </label>


                &nbsp;
                <nb-tag  status="info" appearance="filled" text=" {{totalToPay}} Dinars "></nb-tag>



            </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <button nbButton status="basic">prev</button>
                    </div>
                    <div class="col-md-6">

                        <button (click)="addPenalty()" nbButton status="basic" nbButton nbStepperNext>next</button>
                    </div>
                </div>
            </nb-step>



            <nb-step [label]="labelThree">
                <div class="col-md-12">
                    <ng-template #labelThree>Reminders & Documents</ng-template>
                 
                    &nbsp;
                    <div class="col-md-12">
                        <label> Invoice</label>
                        <button nbButton status="basic"  shape="round" size="small"><em style="font-size: 18px;color:red" class="fas fa-file-pdf"></em></button>

                    </div>
                    &nbsp;

                    <div class="col-md-12" *ngIf="dossier?.relance?.id">
                        <label> Mail Reminder </label>
                        <ngx-pdf [id]="dossier?.relance?.id"></ngx-pdf>

                    </div>
                    &nbsp;

                    <div class="col-md-12">
                        <label> Second Reminder</label>
                        <button nbButton status="basic"  shape="round" size="small"><em style="font-size: 18px;color:red" class="fas fa-file-pdf"></em></button>

                    </div>
                    &nbsp;

                    <div class="col-md-12">
                        <label> OtherDocuments</label>
                        <input nbInput type="file" placeholder="First Name" fullWidth />
                        <div *ngIf="categoriename?.invalid && (categoriename?.dirty || categoriename?.touched)">
                            <p class="text-danger" *ngIf="title?.errors?.required">*Required</p>
                        </div>

                    </div>
                    &nbsp;


                    <div class="row">
                        <div class="col-md-6">
                            <button nbButton status="danger" nbStepperNext>prev</button>
                        </div>
                        <div class="col-md-6">

                            <button nbButton status="success" nbButton nbStepperNext>next</button>
                        </div>
                    </div>

                </div>
            </nb-step>




            <nb-step label="Lawyers">
                
                <div class="validation-checkboxes">
                    <nb-checkbox status="success"  [(ngModel)]="inputHidden">Choose the lawyer to assign to this folder</nb-checkbox>
                  </div>
                <br>
                <br>
                <div class="form-group">
                     
                    <div class="col"  *ngIf="inputHidden"  >

                        <label>Lawyer Name</label>
                        <nb-select (selectedChange)="selectAvocat($event)" class="col-md-12" placeholder="Choose your Lawyer">
                            <nb-option *ngFor="let avocat of dataAvocats" [value]="avocat">{{avocat.nom}}</nb-option>
                           

                        </nb-select>


                    </div>
                    
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <button nbButton status="danger" nbStepperNext>prev</button>
                    </div>
                    <div class="col-md-6">

                        <button (click)="addAvocat()" nbButton status="success" nbButton nbStepperNext>next</button>
                    </div>
                </div>
            </nb-step>
            <nb-step label="Follow up">
                <ng-template #labelFour>Fourth step</ng-template>
                <td>
                    <nb-toggle status="success" (click)="disableNaf()" [hidden]="disabledtoggle"></nb-toggle>
                </td>
                <div class="row">
                <div class="col-md-4">
                    <nb-accordion>
                      <nb-accordion-item expanded="true">
                       <nb-accordion-item-header>Customer Details</nb-accordion-item-header>
                       <nb-accordion-item-body>
                        <div class="col-25">
                          <label for="fname">First Name :{{dossier?.relance?.invoice?.clientName}}</label>
                        </div>
                      <div class="col-25">
                        <label for="IN">Invoice Name :  {{dossier?.relance?.invoice?.title}}</label>
                        
                      </div>
                      <div class="col-25">
                        <label for="subject">Total Amount : {{dossier?.relance?.invoice?.total}} Dinars</label>
                               
                      </div>
                      <div class="col-25">
                        <label for="subject">Due Date :{{dossier?.relance?.invoice?.dueDate|date:'longDate'}}</label>
                               
                      </div>
                      <div class="col-25">
                        <label for="subject">Customer Phone : {{dossier?.relance?.invoice?.clientPhone}}</label>
                               
                      </div>
                       </nb-accordion-item-body>
                      </nb-accordion-item>
                     </nb-accordion>
              
              
                  </div>
                  <div class="col-md-4">
                    <nb-accordion>
                      <nb-accordion-item expanded="true">
                       <nb-accordion-item-header>Penalty Details</nb-accordion-item-header>
                       <nb-accordion-item-body>
                        <div class="col-25">
                          <label for="fname">Amount : {{dossier?.relance?.invoice?.total}} Dinars </label>
                        </div>
                      <div class="col-25">
                        <label for="IN">Penalty : {{penalty}} Dinars</label>
                               
                      </div>
                      <div class="col-25">
                        <label for="subject">Total Amount to pay : {{totalToPay}} Dinars</label>
                               
                      </div>
                  
                       </nb-accordion-item-body>
                      </nb-accordion-item>
                     </nb-accordion>
              
              
                  </div>
                  <div class="col-md-4">
                    <nb-accordion>
                      <nb-accordion-item expanded="true">
                       <nb-accordion-item-header>Lawyer Details</nb-accordion-item-header>
                       <nb-accordion-item-body>
                        <div class="col-25">
                          <label for="fname">First Name : {{dossier?.avocat?.nom}}</label>
                        </div>
                      <div class="col-25">
                        <label for="IN">Adress : {{dossier?.avocat?.adresse}}</label>
                               
                      </div>
                      <div class="col-25">
                        <label for="subject">Phone : {{dossier?.avocat?.numtelephone}}</label>
                               
                      </div>
                      <div class="col-25">
                        <label for="subject">Email :{{dossier?.avocat?.gmail}}</label>
                               
                      </div>
                       </nb-accordion-item-body>
                      </nb-accordion-item>
                     </nb-accordion>
              
              
                  </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <button nbButton status="danger" nbStepperNext>prev</button>
                    </div>
                    <div class="col-md-6">

                        <button nbButton status="success" nbButton nbStepperNext>next</button>
                    </div>
                </div>
            </nb-step>
        </nb-stepper>
    </nb-card-body>
</nb-card>